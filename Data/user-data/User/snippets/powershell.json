{
	// Place your snippets for powershell here. Each snippet is defined under a snippet name and has a prefix, body and 
	// description. The prefix is what is used to trigger the snippet and the body will be expanded and inserted.

	"New-MwaFunction": {
		"prefix": ["New-MwaFunction"],
		"body": [
			"<#",
			".SYNOPSIS",
			"\tA short one-line action-based description, e.g. 'Tests if a function is valid'",
			".DESCRIPTION",
			"\tA longer description of the function, its purpose, common use cases, etc.",
			".PARAMETER InputObject",
			"\tSpecify the input of this parameter.",
			".NOTES",
			"\tInformation or caveats about the function e.g. 'This function is not supported in Linux'",
			".EXAMPLE",
			"\tNew-MwaFunction @{Name='MyName';Value='MyValue'} -Verbose",
			"\tExplanation of the function or its result. You can include multiple examples with additional .EXAMPLE lines",
			"#>",
			"function New-MwaFunction {",
			"\t[CmdletBinding(SupportsShouldProcess=$$True)]",
			"\tparam(",
			"\t\t#region parameter, to add a new parameter, copy and paste the Parameter-region",
			"\t\t[Parameter(",
			"\t\t\tMandatory=$$true,",
			"\t\t\tValueFromPipeline=$$true,",
			"\t\t\tValueFromPipelineByPropertyName=$$true,",
			"\t\t\tPosition = 0",
			"\t\t)]",
			"\t\t[Object] $$InputObject",
			"\t\t#endregion",
			"\t)",
			"",
			"\tbegin{",
			"\t\t#region Do not change this region",
			"\t\t$$StartTime = Get-Date",
			"\t\t$$function = $($$MyInvocation.MyCommand.Name)",
			"\t\tWrite-Verbose $('[', (Get-Date -f 'yyyy-MM-dd HH:mm:ss.fff'), ']', '[ Begin   ]', $$function -Join ' ')",
			"\t\t#endregion",
			"\t\t$$ret = $$null # or @()",
			"\t}",
			"",
			"\tprocess{",
			"\t\tWrite-Verbose $('[', (Get-Date -f 'yyyy-MM-dd HH:mm:ss.fff'), ']', '[ Process ]', $$function -Join ' ')",
			"\t\tif ($$PSCmdlet.ShouldProcess($$PSBoundParameters.Values)){",
			"\t\t\ttry{",
			"\t\t\t\t$$ret = [PSCustomObject]$$InputObject",
			"\t\t\t\tthrow 'There is something wrong in paradise'",
			"\t\t\t}catch{",
			"\t\t\t\tWrite-Warning $('ScriptName:', $($$_.InvocationInfo.ScriptName), 'LineNumber:', $($$_.InvocationInfo.ScriptLineNumber), 'Message:', $($$_.Exception.Message) -Join ' ')",
			"\t\t\t\t$$Error.Clear()",
			"\t\t\t}",
			"\t\t}",
			"\t}",
			"",
			"\tend{",
			"\t\t#region Do not change this region",
			"\t\tWrite-Verbose $('[', (Get-Date -f 'yyyy-MM-dd HH:mm:ss.fff'), ']', '[ End     ]', $$function -Join ' ')",
			"\t\t$$TimeSpan  = New-TimeSpan -Start $$StartTime -End (Get-Date)",
			"\t\t$$Formatted = $$TimeSpan | ForEach-Object {",
			"\t\t\t'{1:0}h {2:0}m {3:0}s {4:000}ms' -f $$_.Days, $$_.Hours, $$_.Minutes, $$_.Seconds, $$_.Milliseconds",
			"\t\t}",
			"\t\tWrite-Verbose $('Finished in:', $$Formatted -Join ' ')",
			"\t\t#endregion",
			"\t\treturn $$ret",
			"\t}",
			"}",
			"",
			"New-MwaFunction -InputObject @{Firstname='Martin';Name='Walther'} -Verbose"
		],
		"description": "An advanced function from tinuwalther"
	}

}
